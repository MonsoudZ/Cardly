<div class="page-container max-w-4xl">
  <!-- Profile Header -->
  <div class="card p-6 mb-6">
    <div class="sm:flex sm:items-center sm:justify-between">
      <div class="sm:flex sm:items-center">
        <%= render 'shared/components/avatar',
            name: @user.display_name,
            image_url: @user.avatar.presence,
            size: :xl %>
        <div class="mt-4 sm:ml-6 sm:mt-0">
          <h1 class="text-2xl font-bold text-neutral-900"><%= @user.display_name %></h1>
          <p class="mt-1 text-sm text-neutral-500">Member since <%= @user.created_at.strftime("%B %Y") %></p>
        </div>
      </div>
      <%= link_to edit_profile_path, class: "btn-primary btn-md mt-4 sm:mt-0" do %>
        <%= render 'shared/components/icon', name: 'pencil', size: :sm %>
        <span class="ml-2">Edit Profile</span>
      <% end %>
    </div>
  </div>

  <!-- Stats Grid -->
  <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
    <%= render 'shared/components/stat_card',
        title: "Collection Value",
        value: number_to_currency(@user.total_collection_value),
        icon: "currency-dollar",
        variant: :primary %>

    <%= render 'shared/components/stat_card',
        title: "Total Cards",
        value: @user.total_cards_count,
        icon: "credit-card" %>

    <%= render 'shared/components/stat_card',
        title: "For Sale",
        value: @user.items_for_sale.count,
        icon: "tag" %>

    <%= render 'shared/components/stat_card',
        title: "For Trade",
        value: @user.items_for_trade.count,
        icon: "shopping-cart" %>
  </div>

  <!-- Profile Details -->
  <div class="card mb-6">
    <div class="px-6 py-4 border-b border-neutral-100">
      <h2 class="text-lg font-semibold text-neutral-900">Profile Details</h2>
    </div>
    <dl class="divide-y divide-neutral-100">
      <% if @user.name.present? %>
        <div class="px-6 py-4 sm:grid sm:grid-cols-3 sm:gap-4">
          <dt class="text-sm font-medium text-neutral-500">Display Name</dt>
          <dd class="mt-1 text-sm text-neutral-900 sm:col-span-2 sm:mt-0"><%= @user.name %></dd>
        </div>
      <% end %>
      <div class="px-6 py-4 sm:grid sm:grid-cols-3 sm:gap-4">
        <dt class="text-sm font-medium text-neutral-500">Email</dt>
        <dd class="mt-1 text-sm text-neutral-900 sm:col-span-2 sm:mt-0"><%= @user.email %></dd>
      </div>
      <div class="px-6 py-4 sm:grid sm:grid-cols-3 sm:gap-4">
        <dt class="text-sm font-medium text-neutral-500">Collections</dt>
        <dd class="mt-1 text-sm text-neutral-900 sm:col-span-2 sm:mt-0"><%= @user.collections.count %></dd>
      </div>
    </dl>
  </div>

  <!-- Seller Payout Settings -->
  <div class="card">
    <div class="px-6 py-4 border-b border-neutral-100">
      <h2 class="text-lg font-semibold text-neutral-900">Seller Payout Settings</h2>
    </div>
    <div class="p-6">
      <% if @user.stripe_connect_onboarded? %>
        <div class="alert-success">
          <div class="flex items-start">
            <%= render 'shared/components/icon', name: 'check', size: :md, color: 'text-success-600' %>
            <div class="ml-3">
              <h3 class="font-medium text-success-800">Seller Account Connected</h3>
              <p class="text-sm text-success-700 mt-1">
                Your Stripe account is set up and ready to receive payouts.
                <% if @user.stripe_connect_payouts_enabled? %>
                  Payouts are enabled.
                <% else %>
                  Payouts are pending verification.
                <% end %>
              </p>
              <%= link_to stripe_connect_onboard_path, class: "mt-3 inline-flex items-center text-sm text-success-700 hover:text-success-900 font-medium" do %>
                Manage Payout Settings â†’
              <% end %>
            </div>
          </div>
        </div>
      <% else %>
        <div class="alert-warning">
          <div class="flex items-start">
            <%= render 'shared/components/icon', name: 'exclamation', size: :md, color: 'text-warning-600' %>
            <div class="ml-3">
              <h3 class="font-medium text-warning-800">Set Up Seller Account</h3>
              <p class="text-sm text-warning-700 mt-1">
                To receive payouts when you sell gift cards, connect your bank account through Stripe.
                This only takes a few minutes.
              </p>
              <%= link_to stripe_connect_onboard_path, class: "mt-4 btn-md bg-warning-600 text-white hover:bg-warning-500 inline-flex items-center rounded-button font-medium" do %>
                <%= render 'shared/components/icon', name: 'arrow-right', size: :sm %>
                <span class="ml-2">Set Up Stripe Connect</span>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
