<%#
  Progress Bar Component

  Usage:
    render 'shared/components/progress_bar', value: 75
    render 'shared/components/progress_bar', value: 50, max: 100, label: 'Balance Used', show_percentage: true
    render 'shared/components/progress_bar', value: 30, variant: :success, size: :lg

  Options:
    - value: Current value (required)
    - max: Maximum value (default: 100)
    - label: Label text (optional)
    - show_percentage: Show percentage text (default: false)
    - show_values: Show value/max text (default: false)
    - variant: :primary (default), :secondary, :success, :warning, :danger
    - size: :sm, :md (default), :lg
%>

<%
  value ||= 0
  max ||= 100
  label ||= nil
  show_percentage ||= false
  show_values ||= false
  variant ||= :primary
  size ||= :md
  html_class ||= ''

  percentage = max > 0 ? [(value.to_f / max * 100).round, 100].min : 0

  variant_colors = {
    primary: 'bg-primary-500',
    secondary: 'bg-secondary-500',
    success: 'bg-success-500',
    warning: 'bg-warning-500',
    danger: 'bg-danger-500'
  }

  size_heights = {
    sm: 'h-1.5',
    md: 'h-2.5',
    lg: 'h-4'
  }

  bar_color = variant_colors[variant]
  bar_height = size_heights[size]
%>

<div class="<%= html_class %>">
  <% if label.present? || show_percentage || show_values %>
    <div class="flex items-center justify-between mb-1.5">
      <% if label.present? %>
        <span class="text-sm font-medium text-neutral-700"><%= label %></span>
      <% else %>
        <span></span>
      <% end %>

      <span class="text-sm text-neutral-500">
        <% if show_values %>
          <%= value %> / <%= max %>
        <% elsif show_percentage %>
          <%= percentage %>%
        <% end %>
      </span>
    </div>
  <% end %>

  <div class="w-full bg-neutral-200 rounded-pill overflow-hidden <%= bar_height %>">
    <div
      class="<%= bar_color %> <%= bar_height %> rounded-pill transition-all duration-500 ease-out"
      style="width: <%= percentage %>%"
      role="progressbar"
      aria-valuenow="<%= value %>"
      aria-valuemin="0"
      aria-valuemax="<%= max %>"
    ></div>
  </div>
</div>
